-- in 2020 April 28,29 and 30 were with high revenue
-- find average payment amunt grouped by customer and day
-- consider only days/customer with more than 1 payment (per customer per day)
select customer_id,date(payment_date),round(avg(amount),2) as avg_amount,count(*)
from payment
where date(payment_date) in ('2020-04-28','2020-04-29','2020-04-30')
group by customer_id, date(payment_date)
having count(*) > 1
order by avg(amount) desc;

